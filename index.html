<!-- If any questions arise pertaining to this website, please reach out to bhatpuneet1@gmail.com -->

<!DOCTYPE html>
<html lang="en-CA">
<head>
	<title>ACL Injury Predictor</title>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
	<script src="script.js"></script>
	<script src="apifunc.js"></script>
	<style>
		body {
			background-color: white;
		}
		.website-footer {
			text-align: center;
			margin-top: 32px;
		}
		.features-display {
			margin-top: 144px;
		}
		.selection-container {
			margin-top: 48px;
		}
		.form-label-spacer {
			margin-top: 16px;
		}
		#unlikely-result, #likely-result {
			margin-top: 32px;
			margin-bottom: 32px;
		}
	</style>
</head>
<body>
	
<nav class="navbar navbar-expand-sm bg-light">
	<div class="container-fluid">
		<div class="navbar-header">
			<a class="nav-brand" href="#">
				<img src="https://i.pinimg.com/originals/38/03/af/3803afa55f1870c4e1e721147dd6db50.png" alt="uwaterloologo" class="rounded" width="80" height="80"/>
			</a>
		</div>
	</div>
</nav>

<div class="container-fluid my-3">
	<center>
		<h1>
			<u>ACL Injury Predictor</u>
		</h1>
	</center>
</div>

<form action="https://bluetr981.github.io/ACL-Injury-Website/" id="submit_form_data" onsubmit="TestAPI()" method="get">
	<h1 class="features-display text-center">Features</h1>
	<div class="container p-5 selection-container bg-light text-dark text-center">
		<label for="selmod" class="form-label">Select Model:</label>
		<select class="form-select" id="selmod" name="select_model" onchange="returnMenuStatus()">
			<option id="model1" value="models/trained_RF_Acc_model_[1, 2, 3, 4, 5]_1.joblib">models/trained_RF_Acc_model_[1, 2, 3, 4, 5]_1.joblib</option>
			<option id="model2" value="models/trained_SVM_Acc_model_[1, 2, 3, 4, 5]_1.joblib">models/trained_SVM_Acc_model_[1, 2, 3, 4, 5]_1.joblib</option>
			<option id="model3" value="models/trained_SVM_Acc_model_[1, 2, 4, 5]_1.joblib">models/trained_SVM_Acc_model_[1, 2, 4, 5]_1.joblib</option>
			<option id="model4" value="models/trained_SVM_F2_model_[2, 3, 4]_1.joblib">models/trained_SVM_F2_model_[2, 3, 4]_1.joblib</option>
			<option id="model5" value="models/trained_XGB_F2_model_[1, 2, 3, 4, 5]_1.json">models/trained_XGB_F2_model_[1, 2, 3, 4, 5]_1.json</option>
		</select>
		<label for="CTS" class="form-label form-label-spacer" id="cts-label">Enter <mark>CTS</mark> (Coronal Tibial Slope) in degrees:</label>
		<input type="text" class="form-control" id="CTS" name="CoronalTibialSlope" value="null" placeholder="Enter CTS" onchange="updateCoronalTibialSlope()">
		<label for="MTS" class="form-label form-label-spacer" id="mts-label">Enter <mark>MTS</mark> (Medial Tibial Slope) in degrees:</label>
		<input type="text" class="form-control" id="MTS" name="MedialTibialSlope" value="null" placeholder="Enter MTS" onchange="updateMedialTibialSlope()" required>
		<label for="LTS" class="form-label form-label-spacer" id="lts-label">Enter <mark>LTS</mark> (Lateral Tibial Slope) in degrees:</label>
		<input type="text" class="form-control" id="LTS" name="LateralTibialSlope" value="null" placeholder="Enter LTS" onchange="updateLateralTibialSlope()">
		<label for="MTD" class="form-label form-label-spacer" id="mtd-label">Enter <mark>MTD</mark> (Medial Tibial Depth) in degrees:</label>
		<input type="text" class="form-control" id="MTD" name="MedialTibialDepth" value="null" placeholder="Enter MTD" onchange="updateMedialTibialDepth()" required>
		<label for="selsex" class="form-label form-label-spacer" id="select-sex">Select Sex (M/F):</label>
		<select class="form-select" id="selsex" name="selectsex" onchange="updateSelectedSex()">
			<option>Male</option>
			<option>Female</option>
		</select>
		<center>
			<button type="submit" class="btn btn-danger mt-5 text-white" id="submit_button">Predict Outcome</button>
		</center>
	</div>
	<script>
		document.getElementById("submit_form_data").addEventListener("submit", function(event) { event.preventDefault(); });
			
		const selectionMenu = document.getElementById("selmod");

		if (sessionStorage.getItem("selected_model") == null) {
			document.getElementById("selmod").value = "";

			document.getElementById("submit_button").style.display = "none";
				
			document.getElementById("cts-label").style.display = "none";
			document.getElementById("CTS").style.display = "none";
			document.getElementById("mts-label").style.display = "none";
			document.getElementById("MTS").style.display = "none";
			document.getElementById("lts-label").style.display = "none";
			document.getElementById("LTS").style.display = "none";
			document.getElementById("mtd-label").style.display = "none";
			document.getElementById("MTD").style.display = "none";
			document.getElementById("select-sex").style.display = "none";
			document.getElementById("selsex").style.display = "none";
		}
		else {
			document.getElementById("submit_button").style.display = "block";
				
			const selectedChoice = sessionStorage.getItem("selected_model");

			for (const x of selectionMenu.options) {
				if (x.value == selectedChoice) {
					x.selected = true;
					break;
				}
			}

			if (selectedChoice == "models/trained_SVM_Acc_model_[1, 2, 4, 5]_1.joblib") {
				document.getElementById("CTS").value = "";
				document.getElementById("CTS").required = true;
				document.getElementById("selsex").value = "";
				document.getElementById("selsex").required = true;

				if (document.getElementById("LTS").required == true) {
					document.getElementById("LTS").required = false;
				}
				
				document.getElementById("lts-label").style.display = "none";
				document.getElementById("LTS").style.display = "none";
			}
			else if (selectedChoice == "models/trained_SVM_F2_model_[2, 3, 4]_1.joblib") {
				document.getElementById("LTS").value = "";
				document.getElementById("LTS").required = true;

				if (document.getElementById("CTS").required == true) {
					document.getElementById("CTS").required = false;
				}	

				if (document.getElementById("selsex").required == true) {
					document.getElementById("selsex").required = false;
				}

				document.getElementById("cts-label").style.display = "none";
				document.getElementById("CTS").style.display = "none";
				document.getElementById("select-sex").style.display = "none";
				document.getElementById("selsex").style.display = "none";
			}
			else {
				document.getElementById("CTS").value = "";
				document.getElementById("LTS").value = "";
				document.getElementById("selsex").value = "";
				
				document.getElementById("CTS").required = false;
				document.getElementById("LTS").required = false;
				document.getElementById("selsex").required = false;
			}
			
			document.getElementById("CTS").value = sessionStorage.getItem("CTS-degrees");
			document.getElementById("MTS").value = sessionStorage.getItem("MTS-degrees");
			document.getElementById("LTS").value = sessionStorage.getItem("LTS-degrees");
			document.getElementById("MTD").value = sessionStorage.getItem("MTD-degrees");
			document.getElementById("selsex").value = sessionStorage.getItem("selected-sex");
		}
		</script>				
	</div>
</form>

<br>

<hr style="margin-top: 64px;" id="hr-bar1">
	
<div class="container" id="unlikely-alert">
	<div class="alert alert-success">
		<h2 class="text-center">Verdict: Unlikely</h2>
		<p><center>Given the following features, it is unlikely that the patient will obtain an ACL injury when participating in sports or any other related activities.</center></p>
	</div>
</div>

<div class="container" id="likely-alert">
	<div class="alert alert-danger">
		<h2 class="text-center">Verdict: Likely</h2>
		<p><center>Given the following values for the features required, it is likely that the patient will obtain an ACL injury when participating in sports or any other related activities.</center></p>
	</div>
</div>

<hr style="margin-bottom: 64px;" id="hr-bar2">

<script>
	const UNLIKELY_RESULT = '0';
	const LIKELY_RESULT = '1';
	
	if (sessionStorage.getItem("RESULT") != null) {
		if (sessionStorage.getItem("RESULT") == UNLIKELY_RESULT) {
			document.getElementById("likely-alert").style.display = "none";
		}
		else {
			document.getElementById("unlikely-alert").style.display = "none";
		}
	}
	else {
		document.getElementById("hr-bar1").style.display = "none";
		document.getElementById("hr-bar2").style.display = "none";
		
		document.getElementById("likely-alert").style.display = "none";
		document.getElementById("unlikely-alert").style.display = "none";
	}
</script>
	
<div class="container-fluid p-5 bg-light website-footer">
	<footer>Â© Dr. Naveen Chandrashekhar, Cheng Hao Kao, and Puneet Bhat 2025</footer>
</div>

</body>
</html>
