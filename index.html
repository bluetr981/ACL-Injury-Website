<!-- If any questions arise pertaining to this website, please reach out to bhatpuneet1@gmail.com -->

<!DOCTYPE html>
<html lang="en-CA">
<head>
	<title>ACL Injury Predictor</title>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
	<link rel="stylesheet" href="styles.css">
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
	<script src="script.js"></script>
	<script src="apifunc.js"></script>
</head>
<body>

<div class="container-fluid my-3">
	<center>
		<h1>
			<u>ACL Injury Predictor</u>
		</h1>
	</center>
</div>

<form action="https://bluetr981.github.io/ACL-Injury-Website/" id="submit_form_data" onsubmit="TestAPI();" method="get">
	<h1 class="features-display text-center">Features</h1>
	<div class="container p-5 selection-container bg-light text-dark text-center">
		<label for="selmod" class="form-label">Select Model:</label>
		<select class="form-select" id="selmod" name="select_model" onchange="clearAllFields()">
			<option id="model1" value="models/trained_RF_Acc_model_[1, 2, 3, 4, 5]_1.joblib">trained_RF_Acc_model_[CTS, MTS, LTS, MTD, Sex]</option>
			<option id="model2" value="models/trained_SVM_Acc_model_[1, 2, 3, 4, 5]_1.joblib">trained_SVM_Acc_model_[CTS, MTS, LTS, MTD, Sex]</option>
			<option id="model3" value="models/trained_SVM_Acc_model_[1, 2, 4, 5]_1.joblib">trained_SVM_Acc_model_[CTS, MTS, MTD, Sex]</option>
			<option id="model4" value="models/trained_SVM_F2_model_[2, 3, 4]_1.joblib">trained_SVM_F2_model_[MTS, LTS, MTD]</option>
			<option id="model5" value="models/trained_XGB_F2_model_[1, 2, 3, 4, 5]_1.json">trained_XGB_F2_model_[CTS, MTS, LTS, MTD, Sex]</option>
		</select>
		<label for="CTS" class="form-label form-label-spacer" id="cts-label">Enter <mark>CTS</mark> (Coronal Tibial Slope) in degrees:</label>
		<input type="text" class="form-control" id="CTS" name="CoronalTibialSlope" value="" placeholder="Enter CTS" onchange="updateCoronalTibialSlope()">
		<label for="MTS" class="form-label form-label-spacer" id="mts-label">Enter <mark>MTS</mark> (Medial Tibial Slope) in degrees:</label>
		<input type="text" class="form-control" id="MTS" name="MedialTibialSlope" value="" placeholder="Enter MTS" onchange="updateMedialTibialSlope()" required>
		<label for="LTS" class="form-label form-label-spacer" id="lts-label">Enter <mark>LTS</mark> (Lateral Tibial Slope) in degrees:</label>
		<input type="text" class="form-control" id="LTS" name="LateralTibialSlope" value="" placeholder="Enter LTS" onchange="updateLateralTibialSlope()">
		<label for="MTD" class="form-label form-label-spacer" id="mtd-label">Enter <mark>MTD</mark> (Medial Tibial Depth) in degrees:</label>
		<input type="text" class="form-control" id="MTD" name="MedialTibialDepth" value="" placeholder="Enter MTD" onchange="updateMedialTibialDepth()" required>
		<label for="selsex" class="form-label form-label-spacer" id="select-sex">Select Sex (M/F):</label>
		<select class="form-select" id="selsex" name="selectsex" onchange="updateSelectedSex()" required>
			<option>Male</option>
			<option>Female</option>
		</select>
	</div>
	
	<div class="container mt-5">
		<center>
			<button type="submit" class="btn btn-danger text-white" id="submit_button">Predict Outcome</button>
			<button type="button" class="btn btn-primary text-white" id="clear_button" onclick="clearAllFields()">Clear Inputs</button>
		</center>
	</div>
	
	<script>
		document.getElementById("submit_form_data").addEventListener("submit", 
		function(event) { 
			event.preventDefault();
		});
			
		const selectionMenu = document.getElementById("selmod");

		if (sessionStorage.getItem("selected_model") == null) {
			document.getElementById("selmod").value = "";

			document.getElementById("submit_button").style.display = "none";
			document.getElementById("clear_button").style.display = "none";
			
			document.getElementById("cts-label").style.display = "none";
			document.getElementById("CTS").style.display = "none";
			document.getElementById("mts-label").style.display = "none";
			document.getElementById("MTS").style.display = "none";
			document.getElementById("lts-label").style.display = "none";
			document.getElementById("LTS").style.display = "none";
			document.getElementById("mtd-label").style.display = "none";
			document.getElementById("MTD").style.display = "none";
			document.getElementById("select-sex").style.display = "none";
			document.getElementById("selsex").style.display = "none";
		}
		else {
			document.getElementById("submit_button").style.display = "inline-block";
			document.getElementById("clear_button").style.display = "inline-block";
			
			const selectedChoice = sessionStorage.getItem("selected_model");

			for (const x of selectionMenu.options) {
				if (x.value == selectedChoice) {
					x.selected = true;
					break;
				}
			}

			if (selectedChoice == "models/trained_SVM_Acc_model_[1, 2, 4, 5]_1.joblib") {
				document.getElementById("CTS").value = "";
				document.getElementById("CTS").required = true;
				document.getElementById("selsex").value = "";
				document.getElementById("selsex").required = true;

				if (document.getElementById("LTS").required == true) {
					document.getElementById("LTS").required = false;
				}
				
				document.getElementById("lts-label").style.display = "none";
				document.getElementById("LTS").style.display = "none";
			}
			else if (selectedChoice == "models/trained_SVM_F2_model_[2, 3, 4]_1.joblib") {
				document.getElementById("LTS").value = "";
				document.getElementById("LTS").required = true;

				if (document.getElementById("CTS").required == true) {
					document.getElementById("CTS").required = false;
				}
				
				if (document.getElementById("selsex").required == true) {
					document.getElementById("selsex").required = false;
				}

				document.getElementById("cts-label").style.display = "none";
				document.getElementById("CTS").style.display = "none";
				document.getElementById("select-sex").style.display = "none";
				document.getElementById("selsex").style.display = "none";
			}
			else {
				document.getElementById("CTS").value = "";
				document.getElementById("LTS").value = "";
				document.getElementById("selsex").value = "";
				
				document.getElementById("CTS").required = true;
				document.getElementById("LTS").required = true;
				document.getElementById("selsex").required = true;
			}
			
			document.getElementById("CTS").value = sessionStorage.getItem("CTS-degrees");
			document.getElementById("MTS").value = sessionStorage.getItem("MTS-degrees");
			document.getElementById("LTS").value = sessionStorage.getItem("LTS-degrees");
			document.getElementById("MTD").value = sessionStorage.getItem("MTD-degrees");
			document.getElementById("selsex").value = sessionStorage.getItem("selected-sex");
		}
		</script>				
	</div>
</form>

<p id="submissionstatus" style="margin-top:48px;text-align:center;"></p>
	
<div class="container" id="result-l">
	<div class="alert alert-danger">
		<h2 class="text-center">Verdict: Likely</h2>
		<p><center>Given the following values for the features required, it is likely that the patient will obtain an ACL injury when participating in sports or any other related activities.</center></p>
	</div>
</div>
	
<div class="container" id="result-u">
	<div class="alert alert-success">
		<h2 class="text-center">Verdict: Unlikely</h2>
		<p><center>Given the following features, it is unlikely that the patient will obtain an ACL injury when participating in sports or any other related activities.</center></p>
	</div>
</div>

<script>
	const UNLIKELY_RESULT = '0';
	const LIKELY_RESULT = '1';
	
	if (sessionStorage.getItem("RESULT") != null) {
		if (sessionStorage.getItem("RESULT") == UNLIKELY_RESULT) {
			document.getElementById("result-l").style.display = "none";
		}
		else {
			document.getElementById("result-u").style.display = "none";
		}
	}
	else {		
		document.getElementById("result-l").style.display = "none";
		document.getElementById("result-u").style.display = "none";
	}
</script>
	
<div class="container-fluid p-5 bg-light website-footer">
	<footer>Â© 2025 Dr. Naveen Chandrashekhar, Cheng Hao Kao, and Puneet Bhat - <a href="https://uwaterloo.ca/structural-biomechanics-lab/">Structural Biomechanics Lab at the University of Waterloo</a></footer>
</div>

</body>
</html>
